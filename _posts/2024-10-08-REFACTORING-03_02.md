---
title: 03. 리팩터링 - 코드에서 나는 악취 (11-17)
description: 인프런 병행
date: 2024-10-08 +0900
categories: [Study, Refactoring, Inflearn]
tags: [Team Study]
---

## <b>기본형 집착</b>
- 기본형(int, String 등..) 만으로는 도메인의 정보를 충분히 표현하지 못함
- 관련 기술
  - 기본형을 객체로 만들기(Replace Primitive with Object)
  - 타입 코드를 서브 클래스로 바꾸기(Replace Type Code with Subclass)
  - 조건부 로직을 다형성으로 바꾸기(Replace Conditional with Polymorphism)
  - 클래스 추출하기(Extract Class)
  - 매개변수 객체 만들기(Introduce Parameter Object)

### 30. 기본형을 객체로 만들기
- 개발 초기에 기본형으로 표현한 데이터가 나중에는 해당 데이터와 관련있는 다양한 기능을 필요로 하는 경우가 발생
- 기본형을 사용한 wrapper 클래스를 생성하고, 필요한 기능을 추가

```java
public class Order {
  /* 우선순위를 갖는 클래스
   * 그러나 priority 는 일반 String 형이므로 아무 값이나 올 수 있음
   * type safety 를 위한 기능 추가 필요 
   * */
  private String priority;
    
  public Order(String priority) {
    this.priorityValue = priority;
  }
}
```

```java
public class Priority {
    private String value;

    private List<String> legalValues = List.of("low", "normal", "high", "rush");

    public Priority(String value) {
        //type safety 를 위해 생성자에 조건추가
        if(legalValues.contains(value)) {
            this.value = value;
        } else {
            throw new IllegalArgumentException("illegal priority value : " + value);
        }
    }

    //우선순위를 확인하기 위한 기능 추가
    public boolean higherThan(Priority other) {
        return this.index() < other.index();
    }

    private int index() {
        return this.legalValues.indexOf(this.value);
    }
}
```

### 31. 타입 코드를 서브클래스로 바꾸기
- 비슷하지만 다른 것들을 표현해야 하는 경우 String, Enum, int 등으로 표현
- 유용한 케이스
  - 조건문을 다형성다형성으로 표현할 수 있는 경우
    - 상속 구조
  - 특정 타입에만 유효한 필드가 있는 경우
    - 스터디 
      - 온라인 : 사용앱, 공유주소
      - 오프라인 : 장소, 대관비용
    - 서브 클래스를 만들고 필드 내리기
```java
public abstract class Employee {
  private String name;

  //외부에서 생성자 사용하지 못하도록
  protected Employee(String name) {
    this.name = name;
  }

  public static Employee createEmployee(String name, String type) {
    return switch (type) {
      case "engineer" -> new Engineer(name);
      case "manager" -> new Manager(name);
      case "salesman" -> new Salesman(name);
      default -> throw new IllegalStateException("Unexpected value: " + type);
    };
  }

  //하위클래스에서 각자 구현할 수 있도록
  protected abstract String getType();
}

// Employee 를 상속받는 서브 클래스를 활용
public class Engineer extends Employee {}
public class Manager extends Employee {}
public class Salesman extends Employee {}

```
